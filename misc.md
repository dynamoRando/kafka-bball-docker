
Some general ksql objects that may be of use are below.

Create a stream for teams:

```
CREATE STREAM SK_TEAM AS SELECT
  S_TEAM.AFTER->ID ID,
  S_TEAM.AFTER->NAME NAME
FROM S_TEAM S_TEAM
PARTITION BY S_TEAM.AFTER->ID
EMIT CHANGES;
```

Create a filtered stream for only active games:

```
CREATE STREAM S_ACTIVE_GAME AS SELECT ID, AWAY_TEAM_ID, HOME_TEAM_ID, QUARTER, CLOCK_IN_SECONDS, CURRENT_POSSESSION_TEAM_ID, AWAY_TEAM_SCORE, HOME_TEAM_SCORE FROM SK_GAME WHERE IS_ACTIVE=1 EMIT CHANGES;
```

Create a key'd stream for active games for the away team:

```
CREATE STREAM SK_AWAY_TEAM_ACTIVE_GAME AS SELECT AWAY_TEAM_ID, HOME_TEAM_ID, QUARTER, CLOCK_IN_SECONDS, CURRENT_POSSESSION_TEAM_ID, AWAY_TEAM_SCORE, HOME_TEAM_SCORE FROM S_ACTIVE_GAME PARTITION BY AWAY_TEAM_ID;
```

And the same for the home teams: 

```
CREATE STREAM SK_HOME_TEAM_ACTIVE_GAME AS SELECT AWAY_TEAM_ID, HOME_TEAM_ID, QUARTER, CLOCK_IN_SECONDS, CURRENT_POSSESSION_TEAM_ID, AWAY_TEAM_SCORE, HOME_TEAM_SCORE FROM S_ACTIVE_GAME PARTITION BY HOME_TEAM_ID;
```

Creating backing tables for re-key'd items:

```
CREATE TABLE TK_AWAY_TEAM_ACTIVE_GAME (AWAY_TEAM_ID BIGINT PRIMARY KEY, HOME_TEAM_ID BIGINT, QUARTER BIGINT, CLOCK_IN_SECONDS BIGINT, CURRENT_POSSESSION_TEAM_ID BIGINT, AWAY_TEAM_SCORE BIGINT, HOME_TEAM_SCORE BIGINT) WITH (KAFKA_TOPIC='SK_AWAY_TEAM_ACTIVE_GAME', VALUE_FORMAT='AVRO');

CREATE TABLE TK_HOME_TEAM_ACTIVE_GAME (AWAY_TEAM_ID BIGINT, HOME_TEAM_ID BIGINT PRIMARY KEY, QUARTER BIGINT, CLOCK_IN_SECONDS BIGINT, CURRENT_POSSESSION_TEAM_ID BIGINT, AWAY_TEAM_SCORE BIGINT, HOME_TEAM_SCORE BIGINT) WITH (KAFKA_TOPIC='SK_HOME_TEAM_ACTIVE_GAME', VALUE_FORMAT='AVRO');
```

Creating intermediate tables for blending data:

```
CREATE TABLE TI_AWAY_TEAM_GAME AS SELECT G.ID, G.AWAY_TEAM_ID, G.HOME_TEAM_ID, A.NAME AWAY_TEAM,  G.QUARTER, G.CLOCK_IN_SECONDS, G.CURRENT_POSSESSION_TEAM_ID, G.AWAY_TEAM_SCORE, G.HOME_TEAM_SCORE, G.IS_ACTIVE FROM T_GAME G INNER JOIN T_TEAM A ON G.AWAY_TEAM_ID = A.ID;

CREATE TABLE T_TEAM_NAME_GAME AS SELECT G.G_ID, G.AWAY_TEAM, H.NAME HOME_TEAM, G.QUARTER, G.CLOCK_IN_SECONDS, G.CURRENT_POSSESSION_TEAM_ID, G.AWAY_TEAM_SCORE, G.HOME_TEAM_SCORE, G.IS_ACTIVE FROM TI_AWAY_TEAM_GAME G INNER JOIN T_TEAM H ON G.HOME_TEAM_ID = H.ID;
```